# üîß API Changes Required for Warehouse Module

## Overview
FE team c·∫ßn BE team ƒëi·ªÅu ch·ªânh m·ªôt s·ªë API endpoints cho module qu·∫£n l√Ω kho ƒë·ªÉ c·∫£i thi·ªán UX v√† ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.

---

## 1. Auto-generate Material Code (M√£ V·∫≠t T∆∞)

### Current Behavior
- User ph·∫£i t·ª± nh·∫≠p m√£ v·∫≠t t∆∞ (VD: `VT001`)
- D·ªÖ g√¢y tr√πng l·∫∑p v√† kh√¥ng nh·∫•t qu√°n

### Required Changes
- **BE t·ª± ƒë·ªông generate m√£ v·∫≠t t∆∞** theo format: `INV-YYYY-XXX`
  - V√≠ d·ª•: `INV-2026-001`, `INV-2026-002`
- **Remove field `materialCode`** kh·ªèi POST request body
- **Response ph·∫£i tr·∫£ v·ªÅ** m√£ v·∫≠t t∆∞ ƒë√£ ƒë∆∞·ª£c generate

### Endpoint Affected
```
POST /api/v1/materials (ho·∫∑c endpoint t∆∞∆°ng t·ª±)
```

### Request Body (Before)
```json
{
  "materialCode": "VT001",  // ‚ùå Remove this
  "materialName": "Lidocaine 2%",
  "group": "V·∫≠t t∆∞ ti√™u hao",
  "units": [...]
}
```

### Request Body (After)
```json
{
  "materialName": "Lidocaine 2%",
  "group": "V·∫≠t t∆∞ ti√™u hao",
  "units": [...]
}
```

### Response
```json
{
  "materialCode": "INV-2026-001",  // ‚úÖ Auto-generated by BE
  "materialName": "Lidocaine 2%",
  ...
}
```

---

## 2. Auto-generate Invoice Number (S·ªë H√≥a ƒê∆°n)

### Current Behavior
- User ph·∫£i t·ª± nh·∫≠p s·ªë h√≥a ƒë∆°n (VD: `INV-2025-001`)
- User kh√¥ng bi·∫øt format chu·∫©n

### Required Changes
- **BE t·ª± ƒë·ªông generate s·ªë h√≥a ƒë∆°n** theo format: `INV-YYYY-XXX`
- **Remove field `invoiceNumber`** kh·ªèi POST request body
- **Response ph·∫£i tr·∫£ v·ªÅ** s·ªë h√≥a ƒë∆°n ƒë√£ ƒë∆∞·ª£c generate

### Endpoint Affected
```
POST /api/v1/inventory/receipts (ho·∫∑c endpoint phi·∫øu nh·∫≠p kho)
```

### Request Body (Before)
```json
{
  "invoiceNumber": "INV-2025-001",  // ‚ùå Remove this
  "supplier": "Supplier Name",
  "importDate": "2026-01-09",
  "items": [...]
}
```

### Request Body (After)
```json
{
  "supplier": "Supplier Name",
  "importDate": "2026-01-09",
  "items": [...]
}
```

### Response
```json
{
  "invoiceNumber": "INV-2026-001",  // ‚úÖ Auto-generated by BE
  "supplier": "Supplier Name",
  ...
}
```

---

## 3. Remove Fields from Export Form (Phi·∫øu Xu·∫•t Kho)

### Current Behavior
- API c√≥ 2 fields kh√¥ng c·∫ßn thi·∫øt:
  - `department` (Ph√≤ng ban)
  - `referenceCode` (M√£ tham chi·∫øu)

### Required Changes
- **Remove fields** kh·ªèi API schema:
  - ‚ùå `department`
  - ‚ùå `referenceCode`

### Endpoint Affected
```
POST /api/v1/inventory/exports (ho·∫∑c endpoint phi·∫øu xu·∫•t kho)
GET /api/v1/inventory/exports
PUT /api/v1/inventory/exports/{id}
```

### Request/Response (Before)
```json
{
  "exportType": "USAGE",
  "exportDate": "2026-01-09",
  "department": "Ph√≤ng kh√°m t·ªïng h·ª£p",  // ‚ùå Remove
  "referenceCode": "REQ-2025-001",     // ‚ùå Remove
  "requester": "Dr. Nguyen Van A",
  "items": [...]
}
```

### Request/Response (After)
```json
{
  "exportType": "USAGE",
  "exportDate": "2026-01-09",
  "requester": "Dr. Nguyen Van A",
  "items": [...]
}
```

---

## Priority
üî¥ **High Priority**

### Reason
- ·∫¢nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn UX v√† data consistency
- FE team ƒëang ch·ªù ƒë·ªÉ update UI
- Tr√°nh duplicate/invalid data do user nh·∫≠p tay

---

## Implementation Timeline
- **Expected:** Within 1-2 sprints
- **FE team s·∫Ω update UI** ngay khi BE confirm API changes

---

## Contact
- **FE Team:** ThisIsLAK, Quanvnm
- **Questions:** Please create a thread in team channel or comment on this issue

---

**Date Created:** January 9, 2026
**Status:** üü° Pending BE Review
